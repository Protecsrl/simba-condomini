CREATE OR REPLACE VIEW V_APPARATO AS

select 
 'APP'||app.oid  as oid,
       app.descrizione,
       app.descrizione as Name,
        case when app.apparatopadre is not null then null else 'IMP'||app.impianto end
        as Impianto,
       case when app.apparatopadre is not null then 'APP'||app.apparatopadre else null end
        as apparatopadre,
       app.oid as apparato

from APPARATO app